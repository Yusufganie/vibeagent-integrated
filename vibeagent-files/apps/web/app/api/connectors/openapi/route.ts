import { NextRequest } from 'next/server';export async function POST(req:NextRequest){const{spec}=await req.json();const base=spec?.servers?.[0]?.url||'';const actions:any[]=[];for(const[path,methods]of Object.entries<any>(spec.paths||{})){for(const[m,op]of Object.entries<any>(methods)){const id=(op.operationId||`${m}_${path}`).replace(/[^a-zA-Z0-9_\-]/g,'_');const input=op.requestBody?.content?.['application/json']?.schema||{type:'object',properties:{}};const output=op.responses?.['200']?.content?.['application/json']?.schema||{type:'object'};actions.push({id,title:op.summary||id,description:op.description||'',method:m.toUpperCase(),path,input,output});}}const manifest={name:(spec.info?.title||'openapi-connector').toLowerCase().replace(/[^a-z0-9\-]/g,'-'),version:spec.info?.version||'0.1.0',description:spec.info?.description||'Generated from OpenAPI',auth:{type:'token',env:['API_TOKEN']},baseUrl:base,actions};return Response.json({manifest});}